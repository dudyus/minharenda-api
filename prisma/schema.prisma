generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgres"
  url      = env("DATABASE_URL")
}

model Usuario {
    id              String          @db.VarChar(36) @id @default(uuid())
    nome            String          @db.VarChar(50)
    email           String          @db.VarChar(100) @unique
    senha           String          @db.VarChar(60)
    cpf             String          @db.VarChar(11)
    celular         String          @db.VarChar(11)
    admin           Boolean         @default(false)
    created_at      DateTime        @default(now()) @db.Timestamp(6)
    updated_at      DateTime        @updatedAt @db.Timestamp(6)
    vipLevel        Int             @default(0)
    despesas        Despesa[]
    estoques        Estoque[]
    receitas        Receita[]
    clientes        Cliente[]
    @@map("usuarios")
}

model Estoque {
    id             Int         @id @default(autoincrement())
    produto        String      @db.VarChar(50)
    qtd_gramas     Int
    valorTotal     Float
    valorKG        Float
    valorGM        Float
    usuario        Usuario     @relation(fields: [usuarioId], references: [id])
    usuarioId      String
  @@map("estoques")
}

model Tag {
  id            Int        @id @default(autoincrement())
  nome          String      @db.VarChar(60)
  despesas      Despesa[]
  receitas      Receita[]
  clientes      Cliente[]
  @@map("tags")
}

model Despesa {
    id            Int            @id @default(autoincrement())
    valor         Int            
    categoria     String         @db.VarChar(45)
    anexo         String?        @db.VarChar(255)
    createdAt     DateTime       @default(now())
    updatedAt     DateTime       @updatedAt  
    usuario       Usuario        @relation(fields: [usuarioId], references: [id])
    usuarioId     String  
    tag           Tag?           @relation(fields: [tagId], references: [id])
    tagId         Int?
    fornecedor    Fornecedor     @relation(fields: [fornecedorId], references: [id])
    fornecedorId  Int
  @@map("despesas")
}

model Fornecedor {
  id            Int         @id @default(autoincrement())
  nome          String      @db.VarChar(60)
  despesas      Despesa[]
  @@map("fornecedores")
}

model Receita {
    id            Int            @id @default(autoincrement())
    descricao     String         @db.VarChar(45)
    valor         Int            
    categoria     String         @db.VarChar(45)
    anexo         String?        @db.VarChar(255) @default("")
    createdAt     DateTime       @default(now())
    updatedAt     DateTime       @updatedAt  
    usuario       Usuario        @relation(fields: [usuarioId], references: [id])
    usuarioId     String  
    tag           Tag?           @relation(fields: [tagId], references: [id])
    tagId         Int?
    cliente       Cliente        @relation(fields: [clienteId], references: [id])
    clienteId     Int
    @@map("receitas")
}

model Cliente {
    id              Int             @id @default(autoincrement())
    nome            String          @db.VarChar(50)
    endereco        String          @db.VarChar(50)
    notas           String          @db.VarChar(50)
    totalGasto      Float           @default(0)
    numCompras      Int             @default(0)
    tag             Tag?             @relation(fields: [tagId], references: [id])
    tagId           Int?
    usuario         Usuario         @relation(fields: [usuarioId], references: [id])
    usuarioId       String
    receitas        Receita[]
    @@map("clientes")
}